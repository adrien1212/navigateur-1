\documentclass[10pt,a4paper]{article}
\input{preambule}
 
\usepackage{fancyhdr}
\usepackage{multirow}

\begin{document}
\thispagestyle{empty}
\include{coverpage}

\thispagestyle{empty}
\tableofcontents

\newpage
\setcounter{page}{1}
\section{Introduction}
\subsection{Le projet}
Ce projet s'inscrit dans le cadre des unités d'enseignement Technologie Objet et Gestion de Projet dispensées durant le second semestre du cycle ingénieur. L'objectif principal de ce projet est de mettre en application les principes agiles vus en Gestion de Projet. L'implémentation de l'application quand à elle, est un objectif secondaire car les notions de programmation ont été travaillées en TDs et TPs. Il était donc conseillé d'avoir un projet ambitieux qui serait difficile à concrétiser dans le temps imparti : la création d'un navigateur web.

\subsection{Liens utiles}
L'avancement et les sources du projet sont disponibles aux liens suivants :
\begin{itemize}
\item Github \href{https://github.com/simjnd/navigateur/wiki}{https://github.com/simjnd/navigateur/wiki}
\item Trello \href{https://trello.com/b/HyinoLEE/navigateur}{https://trello.com/b/HyinoLEE/navigateur} 
\item SVN \href{http://cregut.svn.enseeiht.fr/2020/1air/cpo/pl/E5}{http://cregut.svn.enseeiht.fr/2020/1air/cpo/pl/E5}
\end{itemize}

\newpage

\section{Organisation de l'équipe}
\subsection{Itération initiale}
Cette première itération a été consacrée à l'organisation du travail. Après avoir assemblé notre équipe et nous être mis d’accord sur le projet que nous réaliserions ensemble, nous avons jugé important de consulter chaque membre de l’équipe afin de connaître sa vision et ses ambitions pour notre application. Nous avons ainsi pu nous accorder sur une vision commune : pas seulement un navigateur de base, mais un, dont les fonctionnalités rivalisent avec les navigateurs modernes. De cette vision a découlé une idée générale des fonctionnalités principales de notre navigateur.\\ 

Avant d’aller plus loin, nous nous sommes mis d’accord sur les outils que nous utiliserions. Nous avons commencé par créer un tableau Kanban sur \href{https://trello.com/b/HyinoLEE/navigateur}{\underline{Trello}} afin de transcrire notre avancée sur le projet et l'état des users stories. Ensuite, un dépôt Git a été créé sur la plateforme \href{https://github.com/simjnd/navigateur/}{\underline{GitHub}}. Sur ce dépôt nous avons également mis en place un \href{https://github.com/simjnd/navigateur/wiki}{\underline{wiki}} interne sur lequel nous détaillons le workflow Git. Afin de faciliter l'entraide, nous utiliserons l'IDE IntelliJ. \\

Une fois les outils en place, nous avons pu commencer à fournir le backlog du projet. Nous avons commencé par lister les épiques importantes : la gestion des données de navigation, les onglets, l’historique, le gestionnaire de téléchargement. Nous les avons ensuite décomposées en user stories individuelles avec une évaluation des points d’efforts et de leur valeur métier. Pour les métriques, nous avons respectivement utilisé les tailles de t-shirt (S, L, XL), et une échelle de 1 à 10.


\subsection{Organisation générale}

Après avoir identifié les différentes épiques et user stories, nous avons procédé à un planning poker pour déterminer les points d'efforts et valeurs métier de ces stories. \\
Nous avons ensuite fournit le backlog du premier sprint, au début duquel nous avons chacun choisi les stories sur lesquelles nous souhaitions travailler. Au début des périodes de travail nous partagions des croissants pour du teambuilding et nous réalisons un "daily" au cours duquel nous faisions le point sur notre progression, puis au cours des périodes de travail nous communiquions pour être sûr qu'aucun de nous ne soit bloqué.

\subsection{Organisation à chaque sprint}
Au début de chaque sprint nous menions un \textit{Sprint Planning} au cours duquel nous établissions l’objectif et la vision du sprint dans le but de fédérer et motiver l’équipe. De plus, cela nous permettait d'avoir une vision globale de l'avancemenet du projet. \\

Cette vision nous guidait dans le choix des \textit{User Stories} à réaliser dans le sprint. Nous cherchions un équilibre dans les valeurs métiers et points d’efforts afin de ne pas avoir une surcharge avec trop d’user stories critiques. Cependant, il nous fallait quand même un backlog de sprint qui correspond à notre vélocité. \\

Chaque membre de l’équipe choisissait ensuite la prochaine user story sur laquelle il souhaitait travailler. Il créait ainsi une nouvelle une branche de travail sur git. Une fois sa story implémentée et testée, il devait résoudre les conflits avec la branche principale (branche \verb|dev|). Une fois le code poussé sur GitHub une \textit{Pull Request} est créée afin que les autres membres de l'équipe effectuent et une validation. \\

Au début de chaque séance de travail, nous menions un \textit{Daily} au cours duquel chaque membre faisait un point de son avancement, évoquait ses problèmes bloquants, et ce qu'il souhaitait faire durant la séance de travail. \\
 
Au cours d’un sprint nous prenions du temps pour un \textit{Sanity Check} durant lequel nous nous consultions afin de voir si les users stories engagées ne nécessitaient pas un nouveau raffinage, et si les points d’effort avaient été mesurés précisément. Plus particulièrement, au premier sprint nous avons du raffiner des users stories par manque d’expérience. \\

La fin de chaque sprint donnait lieu à plusieurs échanges : d’abord une \textit{Sprint Review}, au cours de laquelle nous présentions la nouvelle version du navigateur, soit à l'encadrant quand c’était possible, soit entre nous afin que l’équipe puisse voir le résultat des efforts engagés. Ensuite une \textit{Rétrospective de Sprint} au cours de laquelle nous évaluions notre alignement avec nos objectifs : le respect des méthodes agiles, l’ambiance et l’attitude de travail. Ainsi, nous décidions ensemble des mesures à adopter si besoin pour corriger notre trajectoire. Enfin nous faisions une session d’entretien du backlog préalable au sprint planning suivant. Cela nous permettait de réévaluer les points d’efforts, de raffiner des users stories grâce à l’expérience acquise.


\newpage

\section{Découpage des fonctionnalités}
Avant de débuter la conception du projet, nous avons dû établir les principales fonctionnalités puis définir leur point d'effort et leur valeur métier. Une fois ces deux métriques définies, nous avons établie les fonctionnalités à faire dans chaque sprint. 

\subsection{Liste des fonctionnalités}
\begin{table}[H]
\begin{tabular}{|c|l|l|l|}
\hline
\textbf{Epiques}                           & \multicolumn{1}{c|}{\textbf{Fonctionnalité}} & \multicolumn{1}{c|}{\textbf{Point d'effort}} & \multicolumn{1}{c|}{\textbf{Valeur métier}} \\ \hline
\multirow{6}{*}{Fenetre}                & Avoir l'affichage                            & M                                            & 10                                          \\ \cline{2-4} 
                                        & Bouton rafraîchir                            & S                                            & 8                                           \\ \cline{2-4} 
                                        & Bouton précédent                             & S                                            & 8                                           \\ \cline{2-4} 
                                        & Bouton suivant                               & S                                            & 8                                           \\ \cline{2-4} 
                                        & Barre de recherche                           & S                                            & 10                                          \\ \cline{2-4} 
                                        & Bouton Menu                                  & S                                            & 6                                           \\ \hline
\multirow{5}{*}{Historique}             & Enregistrer historique                       & XL                                           & 4                                           \\ \cline{2-4} 
                                        & Afficher historique                          & L                                            & 4                                           \\ \cline{2-4} 
                                        & Supprimer historique                         & S                                            & 4                                           \\ \cline{2-4} 
                                        & Rechercher historique                        & S                                            & 3                                           \\ \cline{2-4} 
                                        & Cliquer sur lien dans historique             & M                                            & 4                                           \\ \hline
\multirow{5}{*}{Onglet}                 & Ajouter onglet                               & XL                                           & 8                                           \\ \cline{2-4} 
                                        & Naviguer entre onglet                        & L                                            & 8                                           \\ \cline{2-4} 
                                        & Supprimer onglet                             & M                                            & 8                                           \\ \cline{2-4} 
                                        & Interchanger onglet                          & XL                                           & 3                                           \\ \cline{2-4} 
                                        & Grouper onglet                               & XL                                           & 3                                           \\ \hline
\multirow{5}{*}{Barre recherche}        & Écrire dans la barre                         & M                                            & 5                                           \\ \cline{2-4} 
                                        & Loader (barre de chargement)                 & S                                            & 3                                           \\ \cline{2-4} 
                                        & Sauvegarder les cookies                      & L                                            & 6                                           \\ \cline{2-4} 
                                        & Suggestion basée sur historique              & L                                            & 6                                           \\ \cline{2-4} 
                                        & Choisir son moteur de recherche              & L                                            & 6                                           \\ \hline
\multirow{5}{*}{Favoris}                & Ajouter la page actuelle favoris             & M                                            & 7                                           \\ \cline{2-4} 
                                        & Modifier nom d'un favori                         & L                                            & 5                                           \\ \cline{2-4} 
                                        & Modifier adresse principale favori                     & L                                            & 5                                           \\ \cline{2-4} 
                                        & Créer un dossier                             & L                                            & 7                                           \\ \cline{2-4}
                                        & Cliquer sur un favori                             & S                                            & 7                                           \\ \cline{2-4} 
                                        & Modifier nom dossier                         & L                                            & 5                                           \\ \hline
\multirow{4}{*}{Mot de passe}           & Proposer génération lors d'une inscription   & L                                            & 4                                           \\ \cline{2-4} 
                                        & Saisie automatique du mot de passe           & XL                                           & 4                                           \\ \cline{2-4} 
                                        & Afficher liste des mots de passes            & M                                            & 4                                           \\ \cline{2-4} 
                                        & Détection des mots de passe pwned            & M                                            & 2                                           \\ \hline
\multirow{3}{*}{Téléchargement}         & Choix du dossier destination                 & M                                            & 4                                           \\ \cline{2-4} 
                                        & Etat du téléchargement                       & XL                                           & 5                                           \\ \cline{2-4} 
                                        & Liste des téléchargement                     & M                                            & 4                                           \\ \hline
\multirow{3}{*}{Données navigations}    & Sauvegarder cookies                          & L                                          & 6                                           \\ \cline{2-4} 
                                        & Sauvegarde localstorage                      & L                                           & 7                                         
                                             \\ \hline
\multicolumn{1}{|l|}{Navigation privée} & Navigation privée                            & M                                            & 6    
                                             \\ \hline

\end{tabular}
\end{table}


\let\thefootnote\relax\footnotetext{
Vous pouvez retrouver ces mêmes user stories sur le \href{https://trello.com/b/HyinoLEE/navigateur}{\underline{Trello}}
}



\newpage
\subsection{Fonctionnalités sprint n°1}
Ce premier sprint a été consacré à la mise en place de l'infrastructure nécessaire pour l'utilisation d'un navigateur web. 
Etant donné que nous ne connaissions pas nos capacités, nous avons rajouté de nouvelles tâches lors du \textit{Sanity Check}.
On retrouve ainsi les fonctionnalités suivantes.

\begin{table}[h]
\begin{tabular}{|c|l|l|l|l|}
\hline
\textbf{epiques}               & \multicolumn{1}{c|}{\textbf{Fonctionnalité}} & \multicolumn{1}{c|}{\textbf{Point d'effort}} & \multicolumn{1}{c|}{\textbf{Valeur métier}} & \textbf{Affectée à} \\ \hline
\multirow{6}{*}{Fenetre}    & Avoir l'affichage                            & M                                            & 10                                          & Victor              \\ \cline{2-5} 
                            & Bouton rafraîchir                            & S                                            & 8                                           & Guillaume           \\ \cline{2-5} 
                            & Bouton précédent                             & S                                            & 8                                           & Guillaume           \\ \cline{2-5} 
                            & Bouton suivant                               & S                                            & 8                                           & Guillaume           \\ \cline{2-5} 
                            & Barre de recherche                           & S                                            & 10                                          & Victor              \\ \cline{2-5} 
                            & Bouton Menu                                  & S                                            & 6                                           & Simon J             \\ \hline
\multirow{2}{*}{Historique} & Enregistrer historique                       & XL                                           & 4                                           & Simon M, Adrien     \\ \cline{2-5} 
                            & Afficher historique                          & L                                            & 4                                           & Simon M, Adrien     \\ \hline
Barre recherche             & Loader (barre de chargement)                 & M                                            & 5                                           & Simon J             \\ \hline
\end{tabular}
\end{table}

Ainsi, nous avons pu calculer la vélocité de l'équipe. Étant donné l'utilisation de taille de T-shirt, nous avons défini une conversion arbitraire $S = 3, M = 5, L = 8, XL = 13$. Ainsi, la vélocité du premier sprint était de 46.

\subsubsection{Conclusion du sprint}
Ce premier sprint nous a permis d'avoir une première estimation de la vélocité de l'équipe. De plus, il y a eu une très bonne entente entre les membres de l'équipe, et toutes les tâches fixées ont été réalisées. Cela était donc prometteur pour la suite du projet.


\subsection{Fonctionnalités sprint n°2}
Durant le deuxième sprint nous nous sommes concentré sur la mise en place d'outils pour faciliter la navigation à l'utilisateur. 

\begin{table}[h]
\begin{tabular}{|c|l|l|l|l|}
\hline
\textbf{Épiques}                            & \multicolumn{1}{c|}{\textbf{Fonctionnalité}} & \multicolumn{1}{c|}{\textbf{Point d'effort}} & \multicolumn{1}{c|}{\textbf{Valeur métier}} & \textbf{Affecté à} \\ \hline
\multirow{3}{*}{Onglet}                  & Ajouter un onglet                            & XL                                           & 8                                           & Adrien, Guillaume  \\ \cline{2-5} 
                                         & Naviguer entre onglet                        & L                                            & 8                                           & Adrien, Guillaume  \\ \cline{2-5} 
                                         & Supprimer un onglet                          & L                                            & 8                                           & Adrien, Guillaume  \\ \hline
\multirow{2}{*}{Historique}              & Rechercher historique                        & S                                            & 3                                           & Simon M, Victor    \\ \cline{2-5} 
                                         & Supprimer historique                         & S                                            & 4                                           & Simon M, Victor    \\ \hline
\multicolumn{1}{|l|}{Données navigation} & Sauvegarder cookies à la fermeture           & L                                            & 6                                           & Simon J            \\ \hline
\end{tabular}
\end{table}

La vélocité théorique du sprint était de 48. Mais comme expliqué ci-dessous, nous n'avons pas réussir à finir toutes les fonctionnalités.

\subsubsection{Conclusion du sprint}
Nous avons mal évalué la difficulté pour la mise en place des onglets de navigation. En effet, la tâche s'est avérée plus longue que prévue. De nombreux problèmes auxquels nous n'avions pas pensés nous ont obligé à modifier notre conception et une partie du code réalisé au premier sprint. \\
Par conséquent, l'épique \textit{onglet} sera continuée sur le troisième sprint.

\newpage

\subsection{Fonctionnalités sprint n°3}
Suite à un léger retard pris dans le sprint précédent, nous avons donc du terminer le développement des onglets. Et, le reste de l'équipe a pu se consacrer au développement de nouvelles fonctionnalités.


\begin{table}[h]
\begin{tabular}{|c|l|l|l|l|}
\hline
\textbf{Epiques}                               & \multicolumn{1}{c|}{\textbf{Fonctionnalité}}                                                & \multicolumn{1}{c|}{\textbf{Point d'effort}} & \multicolumn{1}{c|}{\textbf{Valeur métier}} & \textbf{Affecté à} \\ \hline
\multirow{3}{*}{Onglet}                     & Ajouter un onglet                                                                           & XL                                           & 8                                           & Guillaume, Adrien  \\ \cline{2-5} 
                                            & Naviguer entre onglet                                                                       & L                                            & 8                                           & Guillaume, Simon J          \\ \cline{2-5} 
                                            & Supprimer un onglet                                                                         & L                                            & 8                                           & Guillaume, Simon J          \\ \hline
\multirow{3}{*}{Favoris}                    & Créer un dossier                                                                            & L                                            & 7                                           & Simon M            \\ \cline{2-5} 
                                            & Ajouter un favori                                                                           & M                                            & 7                                           & Simon M            \\ \cline{2-5} 
                                            & Cliquer sur un favori                                                                       & S                                            & 7                                           & Simon M             \\ \hline
Barre de recherche                          & \begin{tabular}[c]{@{}l@{}}Choisir son navigateur\\ (fichier de configuration)\end{tabular} & L                                            & 6                                           & Victor             \\ \hline
\multicolumn{1}{|l|}{Navigation privée}     & Navigation privée                                                                           & M                                            & 6                                           & Guillaume          \\ \hline
\multicolumn{1}{|l|}{Données de navigation} & Sauvegarde \textit{localStorage}                                                                     & L                                            & 7                                           & Simon J            \\ \hline
\multirow{2}{*}{Autre}                      & Revue de code BDD                                                                           &                                              &                                             & Adrien             \\ \cline{2-5} 
                                            & Revue de code fichier de conf.                                                              &                                              &                                             & Adrien             \\ \hline
\end{tabular}
\end{table}

La fonctionnalité \textit{Choisir son navigateur} a été sous-évaluée. Bien qu'elle soit finie, elle nous a pris plus de temps que prévue. \\

La vélocité de ce sprint est de 69, ce qui est largement au-dessus des deux dernières vélocités. Mais, il faut considérer que l'épique \textit{onglet} s'est réalisée sur deux sprints. On peut tout de même se demander si certains points d'effort n'ont pas été sur-estimés.

\subsubsection{Conclusion du sprint}

 Le retard a été rattrapé rapidement et nous avons pu développer autant de fonctionnalités que prévu (sans compter les fonctionnalités en retard). 
 Ce troisième et dernier sprint nous a permis d'avoir une application fonctionnelle et mature.

\subsection{Fonctionnalités manquantes}
Ce dernier tableau résume les fonctionnalités qui n'ont pas pu être développées par manque de temps. Cependant, ces fonctionnalités sont peu valorisantes pour l'application, là, où, nous avons voulu nous concentrer sur les services essentiels. En effet, aucune de ces fonctionnalités n'ont une valeur métier importante et leurs points d'effort sont assez élevés. Ces fonctionnalités n'étaient donc pas prioritaires.

\begin{table}[h]
\begin{tabular}{|c|l|l|l|}
\hline
\textbf{Épiques}            & \multicolumn{1}{c|}{\textbf{Fonctionnalité}} & \multicolumn{1}{c|}{\textbf{Point d'effort}} & \multicolumn{1}{c|}{\textbf{Valeur métier}} \\ \hline
\multirow{3}{*}{Favoris} & Modifier nom d'un favori                     & L                                            & 5 \\ \cline{2-4} 
                         & Modifier adresse principal du favori         & L                                            & 5                                           \\ \cline{2-4} 
                         & Modifier nom d'un dossier                    & L                                            & 5                                           \\ \hline
\multirow{4}{*}{Mot de passe}           & Proposer génération lors d'une inscription   & L                                            & 4                                          \\ \cline{2-4} 
                                        & Saisie automatique du mot de passe           & XL                                           & 4                                           \\ \cline{2-4} 
                                        & Afficher liste des mots de passes            & M                                            & 4                                           \\ \cline{2-4} 
                                        & Détection des mots de passe pwned            & M                                            & 2                                           \\ \hline
\multirow{3}{*}{Téléchargement}         & Choix du dossier destination                 & M                                            & 4                                           \\ \cline{2-4} 
                                        & Etat du téléchargement                       & XL                                           & 5                                           \\ \cline{2-4} 
                                        & Liste des téléchargement                     & M                                            & 4                                           \\ \hline
\end{tabular}
\end{table}

\newpage



\section{Choix des technologies}

\subsection{Langage et cadriciels}

Pour ce projet le langage Java était imposé, mais nous avions le choix pour les bibliothèques et cadriciels utilisables.\\

Pour l'interface graphique nous avons donc choisi JavaFX pour plusieurs raisons. La principale est la présence des composants \verb|WebEngine| et \verb|WebView| qui nous permettaient de ne pas re-développer un moteur de rendu de pages Web qui aurait rendu notre projet difficilement réalisable en 3 semaines. \\
D'autres raisons nous ont incité à utiliser JavaFX :
\begin{itemize}
\item SceneBuilder qui permet de réaliser des interfaces graphiques plus simplement à partir d'un fichier fxml 
\item Composants stylisables avec du CSS.
\item Meilleure gestion des événements que Swing. \\
\end{itemize} 

De plus nous avions déjà tous fait du Java Swing à l'IUT mais aussi à l'ENSEEIHT et nous voulions donc essayer une autre technologie.

\subsection{Gestionnaire de dépendances}

Afin de rendre le développement de notre application plus simple nous avons décidé d'utiliser un gestionnaire de dépendances. Cela rend l'installation de dépendances automatique et commune afin d'éviter qu'un développeur se retrouve avec des problèmes de paquets.\\
Nous avons donc choisi \textit|Maven| qui est un outil de gestion de dépendances mais aussi d'automatisation pour l'intégration continue.
Cela nous a permis d'avoir à configurer seulement un fichier \verb|pom.xml| et Maven s'occupait d'ajouter les paquets dans notre projet.

\subsection{Stockage des données}

Pour le stockage des données nous avions deux besoins :
\begin{itemize}
    \item Fichier de configuration : peu de données mais devant être accessible rapidement.
    \item Données de l'utilisateur : grosse quantité de données. \\ 
\end{itemize}

Pour les fichiers de configuration nous avons choisi d'utiliser le format \verb|JSON| qui est simple à créer et à utiliser. \\

Les données liées à l'utilisateur sont plus volumineuses et nous avons donc utilisé une base de données.
\verb|SQLite|  était la meilleure option pour nous. En effet, \verb|SQLite| est une base de données relationnelle, simple et légère. Il n'y a pas besoin de lancer un serveur de base de données, mais nous profitons quand même de la puissance du SQL. Les quantités de données stockées étant raisonnables, cela correspondait parfaitement à nos besoins. De plus, des bibliothèques Java réalisent la communication très facilement.



\newpage

\section{Architecture de l'application}

L'architecture de l'application est très importante afin de s'assurer d'une bonne évolution et maintenabilité. Ainsi, dans cette section nous présenterons l'architecture principale de l'application à travers un diagramme de paquetage, un diagramme de classe et un diagramme de séquence. \\
D'autres choix de conception serons présentés dans la section suivante  \textit{\nameref{choix_conception}}

\subsection{Organisation des paquetages}
Les classes et interfaces de notre application ont été structurées dans nos différents paquetages en respectant le modèle MVC. Nous avons également un paquetage \verb|Utils| qui englobe deux autres paquetages \verb|DB| et  \verb|ConfigurationHandle| qui sont respectivement responsables de la gestion de la base de données et de la gestion des fichiers de configuration.

\begin{center}
\begin{tikzpicture}

\begin{class}[text  width=3.5cm]{Controller}{0,-1}
\end{class}	

\begin{class}[text  width=3cm]{Model}{2.5,-2}
\end{class}	

\begin{class}[text  width=3cm]{Vue}{-2.5,-2}
\end{class}	


\begin{class}[text  width=4.5cm]{Utils}{-8,0}
\attribute {}
\attribute {}
\attribute {}
\attribute {}
\attribute {}
\end{class}	


\begin{class}[text  width=3.5cm]{DB}{-8,-0.8}
\end{class}	


\begin{class}[text  width=3.5cm]{ConfigurationHandle}{-8,-1.5}
\end{class}	


\begin{class}[text  width=3.5cm]{APP}{-3,-4}
\end{class}	

\association{Controller}{}{}{Vue}{}{}
\association{Controller}{}{}{Model}{}{}
\association{Utils}{}{}{Controller}{}{}

\draw[->] (APP.south) |- ++(0, -0.5) -- ++(-8,0) --node[above , sloped ,black]{}  +(0 ,1)  |- (Utils.west);
\draw[->] (APP.south) |- ++(0, -0.5) -- ++(8,0) --node[above , sloped ,black]{}  +(0 ,1)  |- (Controller.east);

\end{tikzpicture}
\end{center}

\subsection{Exemple d'un diagramme de classe}
Les deux sections suivantes illustrent le service \textit{Historique} à travers un  diagramme de classe et un diagramme de séquence. Étant donné que, tous les services de l'application (favoris, onglets, cookies, paramètres) suivent la même architecture nous avons trouvé plus pertinent de ne représenter en détail qu'un seul service. Ainsi, ci-dessous vous retrouvez le diagramme de classe du service \textit{Historique}.

\begin{center}
\begin{tikzpicture}

\begin{class}[text  width=7cm]{HistoryController}{0,0}
\attribute {- objet FXML}
\attribute {- historyEntries : ListView<HistoryEntry>}
\operation {+ initialize() : void }
\operation {- searchHistory() : void}
\operation {- getTabsController() : TabsController}
\operation {+ setTabsController(tc : TabsController) : void}
\end{class}	

\begin{class}[text  width=5cm]{HistoryFXML}{-3,-5}
\end{class}	

\begin{class}[text  width=5cm]{HistoryEntry}{3,-5}
\attribute {id : int}
\attribute {link : String}
\attribute {name : String}
\attribute {date : Date}
\operation {getX() // l'ensemble des getters }
\operation {setX() // l'ensemble des setters }
\end{class}	

\begin{class}[text  width=4cm]{TableHistory}{-9,-1.4}
\end{class}

\association{HistoryController}{}{}{HistoryFXML}{}{}
\association{HistoryController}{}{}{HistoryEntry}{}{}
\association{HistoryController}{}{}{TableHistory}{table}{1}


\end{tikzpicture}
\end{center}

L'implémentation des bases de données pour l'application est présentée plus en détail dans la section \ref{BDD}.

\newpage

\subsection{Exemple d'un diagramme de séquence}
Afin de décrire l'enchainement des évènements entre \verb|Model|, \verb|Vue|, \verb|Controller| et la base de données nous avons réalisé un diagramme de séquence. De même que la section précédente, ce diagramme de séquence est valable pour les favoris, les cookies, les onglets et les paramètres. Ici, nous l'illustrerons avec le service \textit{Historique}.

\begin{center}
\begin{sequencediagram}
\newinst []{User}{:user}
\newthread{App}{:app}
\newinst []{HistFXML}{:histFXML}
\newinst []{HistController}{:histController}
\newinst [1]{TableHistory}{:tableHistory}
\newinst[]{DB}{:DB}

\begin{messcall}{App}{ connection() }{DB}\end{messcall}
\begin{messcall}{User}{ openHistory() }{App}\end{messcall}
\begin{messcall}{App}{ display }{HistFXML}
	\begin{messcall}{HistFXML}{ initialize() }{HistController}
		\begin{messcall}{HistController}{ new TableHistory() }{TableHistory}
			\begin{messcall}{TableHistory}{ create() }{DB}\end{messcall}
			\begin{messcall}{TableHistory}{ load() }{DB}\end{messcall}
		\end{messcall}	
	\end{messcall}
\end{messcall}

\begin{messcall}{User}{ supprime un élément }{HistFXML}
	\begin{call}{HistFXML}{ BTN\_delete.onClick() }{HistController}{delete from interface}
		\begin{messcall}{HistController}{ delete(...) }{TableHistory}
			\begin{messcall}{TableHistory}{ DELETE FROM  }{DB}\end{messcall}
		\end{messcall}
	\end{call}
\end{messcall}


\end{sequencediagram}
\end{center}

\newpage


\section{Choix de conception} \label{choix_conception}

\subsection{Stockage des données}
Lors de la conception de l'application, nous nous sommes demandé s'il serait intéressant d'utiliser une base de données. En effet, nous avons besoin de stocker des informations persistantes telles que l'historique, les favoris, les cookies, etc. Différentes solutions s'offrent à nous pour réaliser le stockage. Nous pouvions soit utiliser un fichier texte soit utiliser une base de données.

\subsubsection{Les fichiers texte}
\indent Ils ont l'avantage d'être simple à créer et à utiliser. De plus si nous utilisons une structure comme JSON ou XML il existe des librairies Java qui permettent de créer et récupérer les informations d'un fichier facilement.

\subsubsection{Une base de données}
\indent Est un outil conçu spécialement pour le stockage d'un grand nombre de données. Cependant, il est plus difficile de manipuler les bases de données en Java que les fichiers. De plus, nous devons également stocker les informations enregistrées en base de données sans que l'utilisateur n'ait besoin d'installer lui même un serveur de base de données. \\
Cette solution bien que plus compliquée à mettre en place a été retenue car elle présente de nombreux avantages une fois la technologie maîtrisée. \\

Ainsi, nous avons choisi une base de données \verb|SQLite| qui permet d'avoir les informations stockées dans un fichier \verb|.db| représentant la base de données. Ensuite, nous devions faire le lien entre nos classes Java (POJOs) et la table SQL. Une solution serait d'utiliser JavaEE et les annotations mais étant données que nous ne souhaitons pas charger le projet nous avons implémenté différents services qui permettent d'interagir avec la base de données.

\subsubsection{Diagramme de classe} \label{BDD}
Ci-dessous nous représentons l'organisation des classes pour la gestions des tables de la base de données.
La classe \verb|DBConnection| permet de gérer l'accès à la base de données. Et, les implémentations de \verb|Table| font le lien entre les objets Java (POJOs) et les tables de la base de données.

\begin{center}
\begin{tikzpicture}
\begin{interface}[text  width=4.5cm]{Table<T>}{0,0}
\operation {+ create() }
\operation {+ insert(data : T) }
\operation {+ delete(data : T) }
\operation {+ selectAll() }
\operation {+ deleteAll() }
\operation {+ deleteData(data : T[]) }
\operation {+ getData() : List<T> }
\end{interface}	


\begin{class}[text  width=5.9cm]{TableHistory}{-3.5,-5.5}
\implement {Table<T>}
\attribute {- data : List<HistoryEntry>}
\attribute {- DBConnection : DBconnection}
\attribute {- \underline{instance : TableHistory}}
\operation {- TableHistory(co : DBConnection) }
\operation {+ \underline{getInstance(co : DBConnection) : TH}}
\end{class}	

\begin{class}[text  width=5.9cm]{TableCookie}{3.5,-5.5}
\implement {Table<T>}
\attribute {- data : List<HttpCookie>}
\attribute {- DBConnection : DBconnection}
\attribute {- \underline{instance : TableCookie}}
\operation {- TableCookie(co : DBConnection) }
\operation {+ \underline{getInstance(co : DBConnection) : TC}}
\end{class}	

	
	
\begin{class}[text  width=5.5cm]{DBConnection}{7.5,0}
\attribute {- connection : Connection}
\attribute {- statement : Statement}
\operation {- DBConnection(co : DBConnection) }
\operation {+ \underline{getInstance() : DBConnection}}
\operation {+ connect()}
\operation {+ close()}
\operation {+ createTable(request : String)}
\operation {+ getConnection() : Connection}
\end{class}	
	

\draw[->] (TableHistory.north) |- ++(0, 0.5) -- ++(-3.5,0) --node[above , sloped ,black]{}  +(0 ,-1)  |- (TableHistory.west);

\draw[->] (TableCookie.north) |- ++(0, 0.5) -- ++(-3.5,0) --node[above , sloped ,black]{}  +(0 ,-1)  |- (TableCookie.west);

\draw[->] (DBConnection.north) |- ++(0, 0.5) -- ++(-3.5,0) --node[above , sloped ,black]{}  +(0 ,-1)  |- (DBConnection.west);

\draw[umlcd  style  dashed  line ,->] (TableHistory.south) |- ++(0, -1) |- ++(11,0) --node[above , sloped ,black]{$<<$ use $>>$} (DBConnection.south);

\draw[umlcd  style  dashed  line] (TableCookie.south) -- ++(0, -1.2) ;

\end{tikzpicture}
\end{center}

Un objet de type \verb|DBConnection| est créé au lancement de l'application. Ensuite, pour pouvoir manipuler les tables, nous devons récupérer cet objet pour pouvoir effectuer des traitements dessus, c'est pour cela que nous le passons en paramètre de nos constructeurs \verb|TableHistory| et \verb|TableCookie|. \\

\newpage

\begin{lstlisting}
class HistoryController {

	private TableHistory table;    
    
    @FXML
    intinialize() {
        table = TableHistory.getInstance(DBConnection.getInstance());
        ...
    }
}

class TableHistory implements Table<HistoryEntry> {

	private List<HistoryEntry> historyList;
	private DBConnection dbConnection;

	private static TableHistory instance;
	
	private TableHistory(DBConnection dbConnection) {
		this.dbConnection = dbConnection;
		this.historyList = new ArrayList<HistoryEntry>();
		
		this.create(); this.selectAll();
	}
	
	public static TableHistory getInstance(DBConnection dbConnection) {
		if(instance == null) {
			instance = new TableHistory(dbConnection);
		}
		return instance;
	}
	
	public void create() {
	    /* utilisation de l'attribut dbConnection */
		dbConnection.createTable("CREATE TABLE ...");
	}
\end{lstlisting}




\newpage

\subsection{Stockage des configurations}
Nous avons souhaité offrir à l'utilisateur la possibilité de configurer certaines options de l'application. 

\subsubsection{Configurer le navigateur}
Premièrement, l'utilisateur peut enregistrer des configurations pour l'intégralité du navigateur web. Par exemple, le moteur de recherche par défaut, si l'utilisateur souhaite être en mode sombre, etc ... \\
De même que dans la section précédente, nous devons nous poser la question s'il faut utiliser une base de données ou un fichier de configuration. Pour ce cas, étant donné que les configurations possibles ne représentent pas un grand nombre de données à stocker, il est plus simple de manier un fichier formaté en JSON.

\begin{verbatim}
config.json
{
    engine: google // le moteur de recherche par défaut est Google
}
\end{verbatim}

L'utilisateur a la possibilité de modifier la valeur du moteur de recherche par défaut depuis le menu \textit{paramètre} de l'application. Ce qui aura pour conséquence de modifier la valeur dans le fichier \verb|config.json|.

\subsubsection{Configurer les moteurs recherches}
Ensuite, nous souhaitons que l'utilisateur puisse ajouter des moteurs de recherche ou des raccourcis de recherche au navigateur. Par exemple au lieu d'aller sur Youtube et d'effectuer une recherche, l'utilisateur peut directement écrire \verb|@youtube nom_video| dans la barre de recherche. \\
Pour ce faire, de même que la configuration du navigateur nous utilisons un fichier JSON en associant un nom et une URL.
\begin{verbatim}
webengine.config
{
    youtube: https://youtube.com/result?search_query=
    google: https://google.com/search?q=
}
\end{verbatim}

L'utilisateur a également la possibilité d'ajouter un raccourci \verb|@| depuis les paramètres du navigateur.


\subsubsection{Diagramme de classe}
Nous présentons ci-dessous, un diagramme de classe sur la configuration de l'application

\begin{center}
\begin{tikzpicture}
\begin{interface}[text  width=4.5cm]{ConfigurationFile}{0,-0.6}
\operation {+ load() }
\operation {+ save() }
\end{interface}	

\begin{class}[text  width=4.5cm]{CFSearchEngineDefault}{-5.5,-4.5}
\implement {ConfigurationFile}
\attribute {- engine : String}
\operation {+ query(url : String) : String}
\operation {+ load() }
\operation {+ save() }
\end{class}	

\begin{class}[text  width=6.5cm]{CFSearchEngineList}{0.5,-4.5}
\implement {ConfigurationFile}
\attribute {- availableEngine : HM<String, String>}
\operation {+ addAvailableEngine(engine, url : String) }
\operation {+ isAvailable(engine : String) : bool. }
\operation {+ load() }
\operation {+ save() }
\end{class}	

\begin{class}[text  width=7cm]{ConfigurationCreator}{-9,0}
\attribute {- configurationFiles : HM<Str, ConfFile>}
\attribute {\underline{- instance : ConfigurationCreator}}
\operation {\underline{+ getInstance() : ConfigurationCreator }}
\operation {+ getConfigurationFile(key : String) : ConfFile }
\operation {- loadConfigurationFiles() }
\end{class}	

\begin{class}[text  width=4cm]{aT}{-10.3,-4.7}
\operation {+ initialize }
\end{class}	

\begin{class}[text  width=4cm]{TabsController}{-10.5,-4.5}
\operation {+ initialize() }
\end{class}	

\aggregation{ConfigurationCreator}{ }{*}{ConfigurationFile}

\draw[->] (ConfigurationCreator.north) |- ++(0, 0.5) -- ++(-4,0) --node[above , sloped ,black]{}  +(0 ,-2)  |- (ConfigurationCreator.west);

\draw[umlcd  style  dashed  line ,->] (TabsController) --node[above ,sloped , black]{} (ConfigurationCreator);
\end{tikzpicture}
\end{center}

C'est dans la méthode \verb|TabsController#initialize()| que nous instancions pour la première fois un objet de type \verb|ConfigurationCreator|. Lors de la création de cet objet, nous exécutons la méthode\verb|loadConfigurationFile()| qui va se charger de créer un nouvel objet pour chaque fichier de configuration avec une clé. Ainsi, par la suite nous pourrons récupérer cet objet grâce à la méthode \verb|getConfigurationFile(key)|

\newpage

\begin{lstlisting}
class TabController {
    @FXML
    void initialize() {
	    config = ConfigurationCreator.getInstance();
    }
}

class ConfigurationCreator {
	
	private ConfigurationCreator() {
		configurationsFiles = new HashMap<>();
		loadConfigurationFiles();
	}
	
	public static ConfigurationCreator getInstance() {
	    /* Singleton */
	}

    public void loadConfigurationFiles() {
	    	configurationsFiles.put("configurationFileNavigator", 
		                                      new ConfigurationFileNavigator());
		    configurationsFiles.put("configurationFileEngineSearch", 
		                                      new ConfigurationFileEngineSearch());
	}
}
\end{lstlisting}

Les autres contrôleurs pourront récupérer les objets associés aux fichiers de configuration. \\ C'est le cas dans \verb|ParametersController| qui a besoin des fichiers de configuration du navigateur et des moteurs de recherche.

\begin{lstlisting}
class ParametersController {
    @FXML
    private void initialize(){
        // get config from file
        ConfigurationCreator config = ConfigurationCreator.getInstance();

        CFSearchEngineDefault configNavigator = 
        		(CFSearchEngineDefault) config.getConfigurationFile("configurationFileNavigator");
        
        CFSearchEngineList configEngineSearch =
        		(CFSearchEngineList) config.getConfigurationFile("configurationFileEngineSearch");
        		
        /* manipulation des fichiers à travers les deux objets */
}
\end{lstlisting}  

\newpage

\subsection{Complémentarité des controlleurs}
L'une des principales difficultés du projet était de pouvoir communiquer entre contrôleurs. En effet, nous avons défini un WebView qui permet d'avoir l'affichage des pages web. Mais lors de l'épique onglet, il a fallu faire en sorte que chaque onglet et une WebView différente. De plus, les boutons de la barre de navigation (suivant, précédent, etc) doivent communiquer seulement avec l'onglet et la WebView courante. \\

Pour résoudre ce problème, nous avons du imbriquer les différents controleurs afin de pouvoir manipuler plusieurs contrôleurs sur la même vue. Ainsi, la vue définie dans le \verb|main.fxml| avec la fenêtre de navigation et la barre de navigation contient également une imbrication pour pouvoir utiliser la classe \verb|TabsController|. \\
\verb|<fx:include fx:id="tab" source="tabs.fxml" VBox.vgrow="ALWAYS" />|

\subsubsection{Communication du fils vers le père}
Et dans le contrôleur du \verb|main.fxml| nous avons
\begin{lstlisting}
@FXML  //  vaut toujours null si manquant
private TabsController tabController;

private void initialize() {
	tabController.setControlsController(this);
	...
}
\end{lstlisting}

La méthode \verb|TabsController.setControlsController| va permettre d'avoir connaissance de la barre de recherche dans la classe \verb|TabsController|. Ainsi, lorsqu'on va changer d'onglet on va pouvoir également changer le nom dans la barre de recherche.
\begin{lstlisting}
/**
 * Assign the window controller instance.
 * @param controlsController the window controller.
 */
public void setControlsController(WebViewController controlsController) {
	this.controlsController = controlsController;
	if (this.controlsController != null) {
		this.addressBar = this.controlsController.getAddressBar();
		this.progressBar = this.controlsController.getProgressBar();
	}
}
\end{lstlisting}

\subsubsection{Communication du père vers le fils}

Nous venons de donner l'instance du contrôleur parent au controleur fils. Maintenant, nous pouvons utiliser les méthodes définies dans \verb|TabsController|. Par exemple en cliquant sur le bouton \textit{ajouter un onglet} qui est défini dans \verb|main.fxml| on va utiliser la méthode \verb|TabsController#addNewTab()|. 
\begin{lstlisting}
newTabButton.setOnAction(new EventHandler<ActionEvent>() {
	@Override
	public void handle(ActionEvent event) {
		tabController.addNewTab(false);
    	tabController.getCurrentTab().getTab().setText("Loading...");
		NavigationUtils.search(addressBar.getText(), tabController.getCurrentTab().getWebView().getEngine());
	}
});
\end{lstlisting}


\section{Conclusion}
\subsection{Pistes d'amélioration}

Avant de conclure ce projet, nous pouvons lister quelques pistes d'amélioration :
\begin{itemize}
\item Pour finaliser le projet, en se basant sur la vélocité, on estime qu'il nous faudrait deux semaines supplémentaires.
\item De même, certains points d'effort ont été mal évalué. Mais, de meilleures estimations nécessitent une plus grande expérience. 
\item Une meilleure conception dès le début du projet aurait pu nous éviter d'avoir recours à du refactoring.
\item Suivre jusqu'à la fin du projet le workflow détaillé sur le GitHub. Car à la fin du projet nous ne nous relisions moins qu'au début (prise de confiance).
\item Enfin, il manque des tests unitaires car l'architecture est très simple et les tests se baseraient principalement sur l'interface graphique.
\end{itemize}

\subsection{Conclusion sur l'agilité}
Le fait d'avoir d'utilisé l'agilité pour ce projet nous a prouvé que ce concept fonctionne bien. En effet, au fur et à mesure des itérations on arrivait à prioriser les tâches et à apporter des modifications sur des points d'effort et des valeurs métier. Ensuite, la répartition des tâches était équitable. Chacun pouvait travailler sur son service indépendamment puis ensuite le mettre en commun via Git. \\
Enfin, nous finissions chaque itération par une rétrospective pour se remettre en question et continuer à s'améliorer.


\subsection{Conclusion du projet}

Notre backlog était très ambitieux, et comportait des épiques et fonctionnalités très poussées. Nous ne sommes pas parvenus à la fin de celui-ci. Les fonctionnalités essentielles, avec les plus grandes valeurs métiers (de 6 à 10) ont été choisies et terminées. Heureusement pour nous, les fonctionnalités les plus difficiles, avec les points d’efforts les plus hauts étaient souvent des fonctionnalités accessoires, ou en tout cas moins critiques (des valeurs métiers de 1 à 5), comme par exemple les épiques concernant le gestionnaire de mot de passes (4 user stories). Nous sommes confiants sur le fait qu’avec un ou deux sprints supplémentaires l’ensemble du backlog aurait pu être réalisé. \\

Nous avons beaucoup apprécié l’opportunité d’enfin mettre en pratique l’agilité pour ce projet au travers de la méthode SCRUM. Nous avons pu faire l’expérience de sa valeur ajoutée : par exemple le fait d’avoir une application fonctionnelle à la fin de chaque itération était très gratifiant et nous encourageait à continuer. Fonctionner par itérations limitait la portée de nos décisions et nous permettait de corriger les erreurs (par exemple mauvaises estimations de user stories). Le fait de beaucoup communiquer lors des retrospective, de faire rapport de son progrès et surtout de ses difficultés a grandement contribué à instaurer un climat d’entraide plutôt qu’une atmosphère de compétition à qui finirait son ticket le premier. \\

Enfin, pour finir de nous imprégner jusqu’au bout de la philosophie agile, nous étions bien-sûr obligés de faire des activités extra-curriculaires de team-building. Nous avons donc organisé avec une autre équipe un week-end de cohésion pour souder nos liens afin de nous aider à mieux avancer ensemble sur le projet.


\end{document}